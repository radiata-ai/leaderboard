<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Model Evaluation Leaderboard</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      padding: 20px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
      font-size: 0.9em;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 6px;
      text-align: center;
    }
    th {
      background-color: #f4f4f4;
    }
    /* Style for clickable/sortable headers (if you later wish to add sorting) */
    .sortable {
      cursor: pointer;
    }
    .sort-arrow {
      font-size: 0.8em;
      margin-left: 4px;
    }
  </style>
</head>
<body>

  <h2>Model Evaluation Leaderboard</h2>
  <table id="leaderboard">
    <thead>
      <!-- Row 1: Overall grouping -->
      <tr>
        <th rowspan="3">Model Name</th>
        <th rowspan="3">Checkpoint</th>
        <th colspan="12">Reconstruction Error</th>
        <th colspan="21">Downstream Models</th>
      </tr>
      <!-- Row 2: Subgroups -->
      <tr>
        <!-- Reconstruction Error splits -->
        <th colspan="3">L1</th>
        <th colspan="3">Perceptual</th>
        <th colspan="3">SSIM</th>
        <th colspan="3">PSNR</th>
        <!-- Downstream Models splits -->
        <th colspan="3">Age (MAE)</th>
        <th colspan="3">Sex (Overall)</th>
        <th colspan="3">Sex (Female)</th>
        <th colspan="3">Sex (Male)</th>
        <th colspan="3">Diagnosis (Overall)</th>
        <th colspan="3">Diagnosis (Alzheimers_disease)</th>
        <th colspan="3">Diagnosis (cognitively_normal)</th>
      </tr>
      <!-- Row 3: Train/Val/Test for each subgroup -->
      <tr>
        <!-- Reconstruction Error -->
        <th>Train</th>
        <th>Val</th>
        <th>Test</th>
        <th>Train</th>
        <th>Val</th>
        <th>Test</th>
        <th>Train</th>
        <th>Val</th>
        <th>Test</th>
        <th>Train</th>
        <th>Val</th>
        <th>Test</th>
        <!-- Downstream Models -->
        <!-- Age (MAE) -->
        <th>Train</th>
        <th>Val</th>
        <th>Test</th>
        <!-- Sex (Overall) -->
        <th>Train</th>
        <th>Val</th>
        <th>Test</th>
        <!-- Sex (Female) -->
        <th>Train</th>
        <th>Val</th>
        <th>Test</th>
        <!-- Sex (Male) -->
        <th>Train</th>
        <th>Val</th>
        <th>Test</th>
        <!-- Diagnosis (Overall) -->
        <th>Train</th>
        <th>Val</th>
        <th>Test</th>
        <!-- Diagnosis (Alzheimers_disease) -->
        <th>Train</th>
        <th>Val</th>
        <th>Test</th>
        <!-- Diagnosis (cognitively_normal) -->
        <th>Train</th>
        <th>Val</th>
        <th>Test</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    async function loadLeaderboard() {
      try {
        const response = await fetch('model_evals.json');
        const data = await response.json();
        const tbody = document.querySelector("#leaderboard tbody");

        data.forEach(model => {
          const row = document.createElement("tr");
          row.innerHTML = `
            <!-- Model Info -->
            <td>${model.model_name}</td>
            <td>${model.checkpoint}</td>
            <!-- Reconstruction Error: L1 -->
            <td>${model.train_l1.toFixed(5)}</td>
            <td>${model.val_l1.toFixed(5)}</td>
            <td>${model.test_l1.toFixed(5)}</td>
            <!-- Reconstruction Error: Perceptual -->
            <td>${model.train_perceptual.toFixed(5)}</td>
            <td>${model.val_perceptual.toFixed(5)}</td>
            <td>${model.test_perceptual.toFixed(5)}</td>
            <!-- Reconstruction Error: SSIM -->
            <td>${model.train_ssim.toFixed(5)}</td>
            <td>${model.val_ssim.toFixed(5)}</td>
            <td>${model.test_ssim.toFixed(5)}</td>
            <!-- Reconstruction Error: PSNR -->
            <td>${model.train_psnr.toFixed(5)}</td>
            <td>${model.val_psnr.toFixed(5)}</td>
            <td>${model.test_psnr.toFixed(5)}</td>
            <!-- Downstream Models: Age (MAE) -->
            <td>${model.downstream_train.mae_age.toFixed(2)}</td>
            <td>${model.downstream_val.mae_age.toFixed(2)}</td>
            <td>${model.downstream_test.mae_age.toFixed(2)}</td>
            <!-- Downstream Models: Sex (Overall) -->
            <td>${(model.downstream_train.acc_sex * 100).toFixed(2)}%</td>
            <td>${(model.downstream_val.acc_sex * 100).toFixed(2)}%</td>
            <td>${(model.downstream_test.acc_sex * 100).toFixed(2)}%</td>
            <!-- Downstream Models: Sex (Female) -->
            <td>${(model.downstream_train.sex_per_class_acc.female * 100).toFixed(2)}%</td>
            <td>${(model.downstream_val.sex_per_class_acc.female * 100).toFixed(2)}%</td>
            <td>${(model.downstream_test.sex_per_class_acc.female * 100).toFixed(2)}%</td>
            <!-- Downstream Models: Sex (Male) -->
            <td>${(model.downstream_train.sex_per_class_acc.male * 100).toFixed(2)}%</td>
            <td>${(model.downstream_val.sex_per_class_acc.male * 100).toFixed(2)}%</td>
            <td>${(model.downstream_test.sex_per_class_acc.male * 100).toFixed(2)}%</td>
            <!-- Downstream Models: Diagnosis (Overall) -->
            <td>${(model.downstream_train.acc_diag * 100).toFixed(2)}%</td>
            <td>${(model.downstream_val.acc_diag * 100).toFixed(2)}%</td>
            <td>${(model.downstream_test.acc_diag * 100).toFixed(2)}%</td>
            <!-- Downstream Models: Diagnosis (Alzheimers_disease) -->
            <td>${(model.downstream_train.diag_per_class_acc.Alzheimers_disease * 100).toFixed(2)}%</td>
            <td>${(model.downstream_val.diag_per_class_acc.Alzheimers_disease * 100).toFixed(2)}%</td>
            <td>${(model.downstream_test.diag_per_class_acc.Alzheimers_disease * 100).toFixed(2)}%</td>
            <!-- Downstream Models: Diagnosis (cognitively_normal) -->
            <td>${(model.downstream_train.diag_per_class_acc.cognitively_normal * 100).toFixed(2)}%</td>
            <td>${(model.downstream_val.diag_per_class_acc.cognitively_normal * 100).toFixed(2)}%</td>
            <td>${(model.downstream_test.diag_per_class_acc.cognitively_normal * 100).toFixed(2)}%</td>
          `;
          tbody.appendChild(row);
        });
      } catch (error) {
        console.error("Error loading leaderboard:", error);
      }
    }

    document.addEventListener('DOMContentLoaded', loadLeaderboard);
  </script>

</body>
</html>